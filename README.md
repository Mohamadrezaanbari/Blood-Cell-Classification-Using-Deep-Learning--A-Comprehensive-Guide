# Blood Cell Classification

این پروژه برای **طبقه‌بندی گلبول‌های سفید خون** به پنج کلاس زیر طراحی شده است:
1. **ALL** (Acute Lymphoblastic Leukemia)
2. **ACL** (Acute Myeloid Leukemia)
3. **CML** (Chronic Myeloid Leukemia)
4. **AML M3** (Acute Myeloid Leukemia M3)
5. **AML non-M3** (Acute Myeloid Leukemia non-M3)

هدف اصلی این پروژه، **تشخیص خودکار نوع سرطان خون** از طریق تصاویر میکروسکوپی سلول‌های خونی هست. این کار با استفاده از تکنیک‌های **یادگیری عمیق** (Deep Learning) و **شبکه‌های عصبی کانولوشنال** (CNN) انجام می‌شه.

---

## **ساختار پروژه**

پروژه از بخش‌های زیر تشکیل شده:

### **۱. پوشه‌ی `data/`**
این پوشه شامل تصاویر آموزشی و تست هست. ساختار این پوشه به صورت زیره:
data/
├── images/ # تصاویر آموزشی
├── masks/ # ماسک‌های آموزشی (اختیاری)




- **تصاویر آموزشی**: برای آموزش مدل‌ها استفاده می‌شن.
- **ماسک‌ها**: برای آموزش مدل U-Net استفاده می‌شن (اگر ماسک‌ها موجود نباشن، به صورت خودکار ساخته می‌شن).
- **تصاویر تست**: برای ارزیابی مدل‌ها استفاده می‌شن.

---

### **۲. پوشه‌ی `models/`**
این پوشه شامل مدل‌های آموزش‌دیده هست. بعد از آموزش مدل‌ها، فایل‌های وزن‌ها در این پوشه ذخیره می‌شن.
models/
├── unet_model.h5 # مدل U-Net آموزش‌دیده
├── resnet_model.h5 # مدل ResNet آموزش‌دیده



---

### **۳. پوشه‌ی `utils/`**
این پوشه شامل ابزارهای کمکی برای لود داده‌ها، پیش‌پردازش، ساخت ماسک و نمایش نتایج هست.
utils/
├── data_loader.py # توابع لود داده‌ها
├── preprocessing.py # توابع پیش‌پردازش
├── mask_generator.py # توابع ساخت ماسک
├── visualization.py # توابع نمایش نتایج



---

### **۴. فایل `train.py`**
این فایل برای **آموزش مدل‌ها** استفاده می‌شه. مراحل زیر رو انجام می‌ده:
1. لود تصاویر آموزشی.
2. ساخت ماسک‌ها (اگر موجود نباشن).
3. نرمال‌سازی داده‌ها.
4. آموزش مدل U-Net برای سگمنتیشن تصاویر.
5. آموزش مدل ResNet برای طبقه‌بندی گلبول‌های سفید.
6. ذخیره‌سازی مدل‌های آموزش‌دیده در پوشه‌ی `models/`.

---

### **۵. فایل `test.py`**
این فایل برای **تست مدل‌ها** استفاده می‌شه. مراحل زیر رو انجام می‌ده:
1. لود تصاویر تست.
2. ساخت ماسک‌های تست (اگر موجود نباشن).
3. نرمال‌سازی داده‌ها.
4. پیش‌بینی با مدل U-Net برای سگمنتیشن تصاویر.
5. پیش‌بینی با مدل ResNet برای طبقه‌بندی گلبول‌های سفید.
6. نمایش نتایج سگمنتیشن و طبقه‌بندی.

---

## **مدل‌های استفاده‌شده در پروژه**

### **۱. مدل U-Net**
- **هدف**: سگمنتیشن تصاویر (جدا کردن گلبول‌های سفید از پس‌زمینه).
- **ساختار**: شامل یک **Encoder** برای استخراج ویژگی‌ها و یک **Decoder** برای بازسازی تصویر در اندازه‌ی اصلی.
- **خروجی**: یک ماسک باینری که نواحی مربوط به گلبول‌های سفید رو مشخص می‌کنه.

---

### **۲. مدل ResNet**
- **هدف**: طبقه‌بندی گلبول‌های سفید به پنج کلاس.
- **ساختار**: از معماری **ResNet50** استفاده می‌کنه که یک مدل پیش‌آموزش‌دیده‌ی قوی برای طبقه‌بندی تصاویر هست.
- **خروجی**: احتمال تعلق تصویر به هر یک از پنج کلاس.

---

## **نحوه اجرای پروژه**

1. **نصب کتاب‌خانه‌های مورد نیاز**:
   ```bash
   pip install -r requirements.txt